<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Figma Parrot</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background-color: #f5f5f5;
      color: #1a1a1a;
      line-height: 1.6;
    }

    .container {
      padding: 20px;
    }

    h1 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #1a1a1a;
    }

    h2 {
      font-size: 16px;
      font-weight: 600;
      margin: 20px 0 10px;
      color: #333333;
    }

    .section {
      background-color: white;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .btn {
      background-color: #0066cc;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
      margin-right: 8px;
      margin-bottom: 8px;
    }

    .btn:hover {
      background-color: #0052a3;
    }

    .btn-secondary {
      background-color: #666666;
    }

    .btn-secondary:hover {
      background-color: #525252;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 12px;
    }

    .mode-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }

    .mode-card {
      background-color: #f9f9f9;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 12px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .mode-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      border-color: #0066cc;
    }

    .mode-name {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .mode-description {
      font-size: 12px;
      color: #666666;
    }

    .control-group {
      margin: 12px 0;
    }

    .control-row {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }

    .control-label {
      width: 120px;
      font-size: 13px;
      color: #333333;
    }

    .control-input {
      flex: 1;
      padding: 6px 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-size: 13px;
    }

    .control-select {
      flex: 1;
      padding: 6px 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-size: 13px;
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 12px 0;
    }

    .status-message {
      background-color: #e3f2fd;
      color: #1976d2;
      border-radius: 4px;
      padding: 12px;
      margin: 10px 0;
      font-size: 14px;
    }

    .error-message {
      background-color: #ffebee;
      color: #c62828;
      border-radius: 4px;
      padding: 12px;
      margin: 10px 0;
      font-size: 14px;
    }

    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: #666666;
    }

    .spinner {
      border: 2px solid #f3f3f3;
      border-top: 2px solid #0066cc;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¦œ Figma Parrot</h1>
    
    <!-- å¤åˆ¶æ¨¡å¼ -->
    <div class="section">
      <h2>å¤åˆ¶æ¨¡å¼</h2>
      <p style="font-size: 13px; color: #666666; margin-bottom: 12px;">é€‰æ‹©å¤åˆ¶æ¨¡å¼å¹¶é…ç½®å‚æ•°</p>
      <div class="mode-grid" id="duplication-modes"></div>
    </div>

    <!-- çº¿æ€§å¤åˆ¶ -->
    <div class="section">
      <h2>çº¿æ€§å¤åˆ¶</h2>
      <div class="control-group">
        <div class="control-row">
          <label class="control-label">å¤åˆ¶æ•°é‡:</label>
          <input type="number" class="control-input" id="linear-count" value="5" min="1" max="100">
        </div>
        <div class="control-row">
          <label class="control-label">æ–¹å‘:</label>
          <select class="control-select" id="linear-direction">
            <option value="horizontal">æ°´å¹³</option>
            <option value="vertical">å‚ç›´</option>
            <option value="diagonal">å¯¹è§’</option>
          </select>
        </div>
        <div class="control-row">
          <label class="control-label">é—´è·:</label>
          <input type="number" class="control-input" id="linear-spacing" value="20" min="1" max="500">
        </div>
      </div>
      <button class="btn" onclick="duplicateLinear()">çº¿æ€§å¤åˆ¶</button>
    </div>

    <!-- ç½‘æ ¼å¤åˆ¶ -->
    <div class="section">
      <h2>ç½‘æ ¼å¤åˆ¶</h2>
      <div class="control-group">
        <div class="control-row">
          <label class="control-label">è¡Œæ•°:</label>
          <input type="number" class="control-input" id="grid-rows" value="3" min="1" max="20">
        </div>
        <div class="control-row">
          <label class="control-label">åˆ—æ•°:</label>
          <input type="number" class="control-input" id="grid-columns" value="3" min="1" max="20">
        </div>
        <div class="control-row">
          <label class="control-label">æ°´å¹³é—´è·:</label>
          <input type="number" class="control-input" id="grid-h-spacing" value="20" min="1" max="500">
        </div>
        <div class="control-row">
          <label class="control-label">å‚ç›´é—´è·:</label>
          <input type="number" class="control-input" id="grid-v-spacing" value="20" min="1" max="500">
        </div>
      </div>
      <button class="btn" onclick="duplicateGrid()">ç½‘æ ¼å¤åˆ¶</button>
    </div>

    <!-- åœ†å½¢å¤åˆ¶ -->
    <div class="section">
      <h2>åœ†å½¢å¤åˆ¶</h2>
      <div class="control-group">
        <div class="control-row">
          <label class="control-label">å¤åˆ¶æ•°é‡:</label>
          <input type="number" class="control-input" id="circular-count" value="8" min="1" max="50">
        </div>
        <div class="control-row">
          <label class="control-label">åŠå¾„:</label>
          <input type="number" class="control-input" id="circular-radius" value="100" min="10" max="1000">
        </div>
        <div class="control-row">
          <label class="control-label">èµ·å§‹è§’åº¦:</label>
          <input type="number" class="control-input" id="circular-start-angle" value="0" min="0" max="360">
        </div>
        <div class="control-row">
          <label class="control-label">ç»“æŸè§’åº¦:</label>
          <input type="number" class="control-input" id="circular-end-angle" value="360" min="0" max="360">
        </div>
      </div>
      <button class="btn" onclick="duplicateCircular()">åœ†å½¢å¤åˆ¶</button>
    </div>

    <!-- éšæœºåˆ†å¸ƒ -->
    <div class="section">
      <h2>éšæœºåˆ†å¸ƒ</h2>
      <div class="control-group">
        <div class="control-row">
          <label class="control-label">å¤åˆ¶æ•°é‡:</label>
          <input type="number" class="control-input" id="random-count" value="10" min="1" max="100">
        </div>
        <div class="control-row">
          <label class="control-label">åŒºåŸŸå®½åº¦:</label>
          <input type="number" class="control-input" id="random-width" value="500" min="100" max="2000">
        </div>
        <div class="control-row">
          <label class="control-label">åŒºåŸŸé«˜åº¦:</label>
          <input type="number" class="control-input" id="random-height" value="500" min="100" max="2000">
        </div>
      </div>
      <button class="btn" onclick="duplicateRandom()">éšæœºåˆ†å¸ƒ</button>
    </div>

    <!-- å˜æ¢æ•ˆæœ -->
    <div class="section">
      <h2>å˜æ¢æ•ˆæœ</h2>
      <div class="control-group">
        <div class="control-row">
          <label class="control-label">å˜æ¢ç±»å‹:</label>
          <select class="control-select" id="transform-type">
            <option value="SCALE">ç¼©æ”¾</option>
            <option value="ROTATION">æ—‹è½¬</option>
            <option value="OPACITY">é€æ˜åº¦</option>
            <option value="COLOR">é¢œè‰²æ¸å˜</option>
          </select>
        </div>
        <div class="control-row">
          <label class="control-label">èµ·å§‹å€¼:</label>
          <input type="number" class="control-input" id="transform-start" value="1" step="0.1">
        </div>
        <div class="control-row">
          <label class="control-label">ç»“æŸå€¼:</label>
          <input type="number" class="control-input" id="transform-end" value="2" step="0.1">
        </div>
      </div>
      <button class="btn" onclick="applyTransform()">åº”ç”¨å˜æ¢</button>
    </div>

    <!-- å¿«æ·æ“ä½œ -->
    <div class="section">
      <h2>å¿«æ·æ“ä½œ</h2>
      <div class="button-group">
        <button class="btn" onclick="smartDuplicate('alternating')">äº¤æ›¿å¤åˆ¶</button>
        <button class="btn" onclick="smartDuplicate('staggered')">äº¤é”™å¤åˆ¶</button>
        <button class="btn" onclick="mirrorDuplicate('horizontal')">æ°´å¹³é•œåƒ</button>
        <button class="btn" onclick="mirrorDuplicate('vertical')">å‚ç›´é•œåƒ</button>
      </div>
    </div>

    <!-- æ“ä½œç»“æœ -->
    <div class="section">
      <h2>æ“ä½œç»“æœ</h2>
      <div id="operation-results"></div>
    </div>
  </div>

  <script>
    // å¤åˆ¶æ¨¡å¼æ•°æ®
    const duplicationModes = [
      {
        id: '1',
        name: 'çº¿æ€§å¤åˆ¶',
        description: 'æ²¿ç›´çº¿æ–¹å‘å¤åˆ¶å…ƒç´ ',
        type: 'LINEAR'
      },
      {
        id: '2',
        name: 'ç½‘æ ¼å¤åˆ¶',
        description: 'æŒ‰ç½‘æ ¼å¸ƒå±€å¤åˆ¶å…ƒç´ ',
        type: 'GRID'
      },
      {
        id: '3',
        name: 'åœ†å½¢å¤åˆ¶',
        description: 'æ²¿åœ†å½¢è·¯å¾„å¤åˆ¶å…ƒç´ ',
        type: 'CIRCULAR'
      },
      {
        id: '4',
        name: 'éšæœºåˆ†å¸ƒ',
        description: 'éšæœºåˆ†å¸ƒå¤åˆ¶çš„å…ƒç´ ',
        type: 'RANDOM'
      }
    ];

    // åˆå§‹åŒ–é¡µé¢
    document.addEventListener('DOMContentLoaded', function() {
      renderDuplicationModes();
    });

    // æ¸²æŸ“å¤åˆ¶æ¨¡å¼
    function renderDuplicationModes() {
      const modesContainer = document.getElementById('duplication-modes');
      modesContainer.innerHTML = duplicationModes.map(mode => `
        <div class="mode-card">
          <div class="mode-name">${mode.name}</div>
          <div class="mode-description">${mode.description}</div>
        </div>
      `).join('');
    }

    // å‘é€æ¶ˆæ¯åˆ°æ’ä»¶ä»£ç 
    function sendMessage(type, data = {}) {
      parent.postMessage({ pluginMessage: { type, ...data } }, '*');
    }

    // çº¿æ€§å¤åˆ¶
    function duplicateLinear() {
      const count = parseInt(document.getElementById('linear-count').value);
      const direction = document.getElementById('linear-direction').value;
      const spacing = parseInt(document.getElementById('linear-spacing').value);
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨çº¿æ€§å¤åˆ¶...</div>';
      sendMessage('duplicate-linear', { count, direction, spacing });
    }

    // ç½‘æ ¼å¤åˆ¶
    function duplicateGrid() {
      const rows = parseInt(document.getElementById('grid-rows').value);
      const columns = parseInt(document.getElementById('grid-columns').value);
      const horizontalSpacing = parseInt(document.getElementById('grid-h-spacing').value);
      const verticalSpacing = parseInt(document.getElementById('grid-v-spacing').value);
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨ç½‘æ ¼å¤åˆ¶...</div>';
      sendMessage('duplicate-grid', { rows, columns, horizontalSpacing, verticalSpacing });
    }

    // åœ†å½¢å¤åˆ¶
    function duplicateCircular() {
      const count = parseInt(document.getElementById('circular-count').value);
      const radius = parseInt(document.getElementById('circular-radius').value);
      const startAngle = parseInt(document.getElementById('circular-start-angle').value);
      const endAngle = parseInt(document.getElementById('circular-end-angle').value);
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨åœ†å½¢å¤åˆ¶...</div>';
      sendMessage('duplicate-circular', { count, radius, startAngle, endAngle });
    }

    // éšæœºåˆ†å¸ƒ
    function duplicateRandom() {
      const count = parseInt(document.getElementById('random-count').value);
      const areaWidth = parseInt(document.getElementById('random-width').value);
      const areaHeight = parseInt(document.getElementById('random-height').value);
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨éšæœºåˆ†å¸ƒ...</div>';
      sendMessage('duplicate-random', { count, areaWidth, areaHeight });
    }

    // åº”ç”¨å˜æ¢
    function applyTransform() {
      const transformType = document.getElementById('transform-type').value;
      const startValue = parseFloat(document.getElementById('transform-start').value);
      const endValue = parseFloat(document.getElementById('transform-end').value);
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨åº”ç”¨å˜æ¢...</div>';
      sendMessage('apply-transform', { transformType, startValue, endValue });
    }

    // æ™ºèƒ½å¤åˆ¶
    function smartDuplicate(pattern) {
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨æ™ºèƒ½å¤åˆ¶...</div>';
      sendMessage('smart-duplicate', { pattern });
    }

    // é•œåƒå¤åˆ¶
    function mirrorDuplicate(direction) {
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨é•œåƒå¤åˆ¶...</div>';
      sendMessage('mirror-duplicate', { direction });
    }

    // å¤„ç†æ¥è‡ªæ’ä»¶ä»£ç çš„æ¶ˆæ¯
    onmessage = (event) => {
      const { type, ...data } = event.data.pluginMessage;
      
      switch (type) {
        case 'duplicated':
        case 'transform-applied':
        case 'smart-duplicated':
        case 'mirrored':
          handleStatusMessage(data.message);
          break;
        case 'error':
          handleErrorMessage(data.message);
          break;
      }
    };

    // å¤„ç†çŠ¶æ€æ¶ˆæ¯
    function handleStatusMessage(message) {
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = `<div class="status-message">${message}</div>`;
    }

    // å¤„ç†é”™è¯¯æ¶ˆæ¯
    function handleErrorMessage(message) {
      const resultsDiv = document.getElementById('operation-results');
      resultsDiv.innerHTML = `<div class="error-message">${message}</div>`;
    }
  </script>
</body>
</html>
