<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Figma CN</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background-color: #f5f5f5;
      color: #1a1a1a;
      line-height: 1.6;
    }

    .container {
      padding: 20px;
    }

    h1 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #1a1a1a;
    }

    h2 {
      font-size: 16px;
      font-weight: 600;
      margin: 20px 0 10px;
      color: #333333;
    }

    .section {
      background-color: white;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .btn {
      background-color: #0066cc;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
      margin-right: 8px;
      margin-bottom: 8px;
    }

    .btn:hover {
      background-color: #0052a3;
    }

    .btn-secondary {
      background-color: #666666;
    }

    .btn-secondary:hover {
      background-color: #525252;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 12px;
    }

    .font-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }

    .font-card {
      background-color: #f9f9f9;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 12px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .font-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      border-color: #0066cc;
    }

    .font-name {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .font-english-name {
      font-size: 12px;
      color: #666666;
      margin-bottom: 4px;
    }

    .font-details {
      font-size: 11px;
      color: #999999;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .rule-list {
      margin-top: 12px;
    }

    .rule-item {
      background-color: #f9f9f9;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 8px;
    }

    .rule-name {
      font-weight: 500;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .rule-description {
      font-size: 12px;
      color: #666666;
      margin-bottom: 8px;
    }

    .rule-examples {
      font-size: 11px;
      color: #999999;
    }

    .example-item {
      margin-bottom: 4px;
    }

    .example-correct {
      color: #4caf50;
    }

    .example-error {
      color: #f44336;
    }

    .resource-list {
      margin-top: 12px;
    }

    .resource-item {
      background-color: #f9f9f9;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 8px;
    }

    .resource-name {
      font-weight: 500;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .resource-description {
      font-size: 12px;
      color: #666666;
      margin-bottom: 4px;
    }

    .resource-url {
      font-size: 11px;
      color: #0066cc;
      text-decoration: none;
    }

    .resource-url:hover {
      text-decoration: underline;
    }

    .control-group {
      margin: 12px 0;
    }

    .control-row {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }

    .control-label {
      width: 120px;
      font-size: 13px;
      color: #333333;
    }

    .control-input {
      flex: 1;
      padding: 6px 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-size: 13px;
    }

    .control-select {
      flex: 1;
      padding: 6px 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-size: 13px;
    }

    .textarea {
      flex: 1;
      padding: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      font-size: 13px;
      resize: vertical;
      min-height: 100px;
    }

    .status-message {
      background-color: #e3f2fd;
      color: #1976d2;
      border-radius: 4px;
      padding: 12px;
      margin: 10px 0;
      font-size: 14px;
    }

    .error-message {
      background-color: #ffebee;
      color: #c62828;
      border-radius: 4px;
      padding: 12px;
      margin: 10px 0;
      font-size: 14px;
    }

    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: #666666;
    }

    .spinner {
      border: 2px solid #f3f3f3;
      border-top: 2px solid #0066cc;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ‡¨ğŸ‡³ Figma CN</h1>
    
    <!-- ä¸­æ–‡å­—ä½“æ¨è -->
    <div class="section">
      <h2>ä¸­æ–‡å­—ä½“æ¨è</h2>
      <p style="font-size: 13px; color: #666666; margin-bottom: 12px;">ä¸ºä¸­æ–‡è®¾è®¡é€‰æ‹©åˆé€‚çš„å­—ä½“</p>
      <div class="font-grid" id="chinese-fonts"></div>
    </div>

    <!-- ä¸­æ–‡æ’ç‰ˆå·¥å…· -->
    <div class="section">
      <h2>ä¸­æ–‡æ’ç‰ˆå·¥å…·</h2>
      <button class="btn" onclick="checkTypography()">æ£€æŸ¥æ’ç‰ˆ</button>
      <button class="btn" onclick="fixPunctuation()">ä¿®å¤æ ‡ç‚¹</button>
      <div id="typography-results" style="margin-top: 16px;"></div>
      
      <h3 style="font-size: 14px; margin: 16px 0 8px;">æ’ç‰ˆè§„åˆ™:</h3>
      <div class="rule-list" id="typography-rules"></div>
    </div>

    <!-- ä¸­æ–‡èµ„æº -->
    <div class="section">
      <h2>ä¸­æ–‡è®¾è®¡èµ„æº</h2>
      <button class="btn" onclick="addChineseResources()">æ·»åŠ å¸¸ç”¨èµ„æº</button>
      <div class="resource-list" id="chinese-resources"></div>
    </div>

    <!-- ç¿»è¯‘å·¥å…· -->
    <div class="section">
      <h2>ç¿»è¯‘å·¥å…·</h2>
      <div class="control-group">
        <div class="control-row">
          <label class="control-label">ç›®æ ‡è¯­è¨€:</label>
          <select class="control-select" id="target-language">
            <option value="en">è‹±æ–‡</option>
            <option value="zh">ä¸­æ–‡</option>
          </select>
        </div>
        <div class="control-row" style="align-items: flex-start;">
          <label class="control-label">æ–‡æœ¬:</label>
          <textarea class="textarea" id="translate-text" placeholder="è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡æœ¬"></textarea>
        </div>
      </div>
      <button class="btn" onclick="translateText()">ç¿»è¯‘</button>
      <div id="translation-results" style="margin-top: 16px;"></div>
    </div>

    <!-- å†…å®¹ç”Ÿæˆ -->
    <div class="section">
      <h2>ä¸­æ–‡å†…å®¹ç”Ÿæˆ</h2>
      <div class="control-group">
        <div class="control-row">
          <label class="control-label">å†…å®¹ç±»å‹:</label>
          <select class="control-select" id="content-type">
            <option value="title">æ ‡é¢˜</option>
            <option value="paragraph">æ®µè½</option>
            <option value="list">åˆ—è¡¨</option>
          </select>
        </div>
        <div class="control-row">
          <label class="control-label">é•¿åº¦:</label>
          <input type="number" class="control-input" id="content-length" value="1" min="1" max="10">
        </div>
      </div>
      <button class="btn" onclick="generateChineseContent()">ç”Ÿæˆå†…å®¹</button>
      <div id="content-results" style="margin-top: 16px;"></div>
    </div>
  </div>

  <script>
    // ä¸­æ–‡å­—ä½“æ•°æ®
    const chineseFonts = [
      {
        id: '1',
        name: 'æ€æºé»‘ä½“',
        englishName: 'Source Han Sans',
        category: 'sans-serif',
        style: 'ç°ä»£æ— è¡¬çº¿',
        recommendation: 'é€šç”¨UIè®¾è®¡',
        url: 'https://fonts.google.com/specimen/Noto+Sans+SC'
      },
      {
        id: '2',
        name: 'æ€æºå®‹ä½“',
        englishName: 'Source Han Serif',
        category: 'serif',
        style: 'ä¼ ç»Ÿè¡¬çº¿',
        recommendation: 'æ­£æ–‡æ’ç‰ˆ',
        url: 'https://fonts.google.com/specimen/Noto+Serif+SC'
      },
      {
        id: '3',
        name: 'è‹¹æ–¹',
        englishName: 'PingFang SC',
        category: 'sans-serif',
        style: 'ç°ä»£æ— è¡¬çº¿',
        recommendation: ' macOS/iOSè®¾è®¡',
        url: 'https://developer.apple.com/fonts/'
      },
      {
        id: '4',
        name: 'å¾®è½¯é›…é»‘',
        englishName: 'Microsoft YaHei',
        category: 'sans-serif',
        style: 'ç°ä»£æ— è¡¬çº¿',
        recommendation: 'Windowsè®¾è®¡',
        url: 'https://docs.microsoft.com/en-us/typography/font-list/microsoft-yahei'
      },
      {
        id: '5',
        name: 'åæ–‡é»‘ä½“',
        englishName: 'ST Heiti',
        category: 'sans-serif',
        style: 'ä¼ ç»Ÿæ— è¡¬çº¿',
        recommendation: 'ä¼ ç»Ÿé£æ ¼è®¾è®¡',
        url: 'https://www.apple.com.cn/support/fonts/'
      },
      {
        id: '6',
        name: 'ç«™é…·åº†ç§‘é»„æ²¹ä½“',
        englishName: 'ZCOOL QingKe HuangYou',
        category: 'display',
        style: 'åˆ›æ„å­—ä½“',
        recommendation: 'æ ‡é¢˜è®¾è®¡',
        url: 'https://fonts.google.com/specimen/ZCOOL+QingKe+HuangYou'
      }
    ];

    // æ’ç‰ˆè§„åˆ™æ•°æ®
    const typographyRules = [
      {
        id: '1',
        name: 'æ ‡ç‚¹æŒ¤å‹',
        description: 'ä¸­æ–‡æ ‡ç‚¹ç¬¦å·ä¹‹é—´ä»¥åŠä¸æ–‡å­—ä¹‹é—´çš„é—´è·ä¼˜åŒ–',
        severity: 'high',
        examples: [
          'æ­£ç¡®: è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºæ­£ç¡®çš„æ ‡ç‚¹ä½¿ç”¨ã€‚',
          'é”™è¯¯: è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ ï¼Œ å±•ç¤ºé”™è¯¯çš„æ ‡ç‚¹ä½¿ç”¨ ã€‚'
        ]
      },
      {
        id: '2',
        name: 'ä¸­è‹±æ–‡æ··æ’',
        description: 'ä¸­è‹±æ–‡æ··åˆæ’ç‰ˆæ—¶çš„ç©ºæ ¼å¤„ç†',
        severity: 'high',
        examples: [
          'æ­£ç¡®: è¿™æ˜¯ Figma æ’ä»¶',
          'é”™è¯¯: è¿™æ˜¯Figmaæ’ä»¶'
        ]
      },
      {
        id: '3',
        name: 'æ•°å­—æ’ç‰ˆ',
        description: 'ä¸­æ–‡ç¯å¢ƒä¸‹çš„æ•°å­—æ’ç‰ˆè§„èŒƒ',
        severity: 'medium',
        examples: [
          'æ­£ç¡®: 100 å…ƒ',
          'é”™è¯¯: ä¸€ç™¾å…ƒ'
        ]
      },
      {
        id: '4',
        name: 'è¡Œé¦–è¡Œå°¾è§„åˆ™',
        description: 'ä¸­æ–‡æ’ç‰ˆä¸­è¡Œé¦–è¡Œå°¾çš„å­—ç¬¦è§„åˆ™',
        severity: 'medium',
        examples: [
          'æ­£ç¡®: ç¡®ä¿è¡Œé¦–ä¸æ˜¯æ ‡ç‚¹ç¬¦å·',
          'é”™è¯¯: ï¼Œç¡®ä¿è¡Œé¦–ä¸æ˜¯æ ‡ç‚¹ç¬¦å·'
        ]
      }
    ];

    // ä¸­æ–‡èµ„æºæ•°æ®
    const chineseResources = [
      {
        id: '1',
        name: 'é˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“',
        url: 'https://www.iconfont.cn/',
        description: 'ä¸­å›½æœ€å¤§çš„çŸ¢é‡å›¾æ ‡åº“',
        category: 'icons'
      },
      {
        id: '2',
        name: 'ç«™é…·',
        url: 'https://www.zcool.com.cn/',
        description: 'è®¾è®¡å¸ˆç¤¾åŒºå’Œèµ„æºå¹³å°',
        category: 'design'
      },
      {
        id: '3',
        name: 'èŠ±ç“£ç½‘',
        url: 'https://huaban.com/',
        description: 'åˆ›æ„çµæ„Ÿåˆ†äº«å¹³å°',
        category: 'inspiration'
      },
      {
        id: '4',
        name: 'å­—ä½“å¤©ä¸‹',
        url: 'https://www.fonts.net.cn/',
        description: 'ä¸­æ–‡å­—ä½“ä¸‹è½½å¹³å°',
        category: 'fonts'
      }
    ];

    // åˆå§‹åŒ–é¡µé¢
    document.addEventListener('DOMContentLoaded', function() {
      renderChineseFonts();
      renderTypographyRules();
      renderChineseResources();
    });

    // æ¸²æŸ“ä¸­æ–‡å­—ä½“
    function renderChineseFonts() {
      const fontsContainer = document.getElementById('chinese-fonts');
      fontsContainer.innerHTML = chineseFonts.map(font => `
        <div class="font-card" onclick="applyChineseFont('${font.id}')">
          <div class="font-name">${font.name}</div>
          <div class="font-english-name">${font.englishName}</div>
          <div class="font-details">
            <span>${font.style}</span>
            <span>${font.recommendation}</span>
          </div>
        </div>
      `).join('');
    }

    // æ¸²æŸ“æ’ç‰ˆè§„åˆ™
    function renderTypographyRules() {
      const rulesContainer = document.getElementById('typography-rules');
      rulesContainer.innerHTML = typographyRules.map(rule => `
        <div class="rule-item">
          <div class="rule-name">${rule.name}</div>
          <div class="rule-description">${rule.description}</div>
          <div class="rule-examples">
            ${rule.examples.map((example, index) => {
              const isCorrect = example.startsWith('æ­£ç¡®:');
              return `<div class="example-item ${isCorrect ? 'example-correct' : 'example-error'}">${example}</div>`;
            }).join('')}
          </div>
        </div>
      `).join('');
    }

    // æ¸²æŸ“ä¸­æ–‡èµ„æº
    function renderChineseResources() {
      const resourcesContainer = document.getElementById('chinese-resources');
      resourcesContainer.innerHTML = chineseResources.map(resource => `
        <div class="resource-item">
          <div class="resource-name">${resource.name}</div>
          <div class="resource-description">${resource.description}</div>
          <a href="${resource.url}" class="resource-url" target="_blank">${resource.url}</a>
        </div>
      `).join('');
    }

    // å‘é€æ¶ˆæ¯åˆ°æ’ä»¶ä»£ç 
    function sendMessage(type, data = {}) {
      parent.postMessage({ pluginMessage: { type, ...data } }, '*');
    }

    // åº”ç”¨ä¸­æ–‡å­—ä½“
    function applyChineseFont(fontId) {
      const resultsDiv = document.getElementById('typography-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨åº”ç”¨å­—ä½“...</div>';
      sendMessage('apply-chinese-font', { fontId });
    }

    // æ£€æŸ¥æ’ç‰ˆ
    function checkTypography() {
      const resultsDiv = document.getElementById('typography-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨æ£€æŸ¥æ’ç‰ˆ...</div>';
      sendMessage('check-typography');
    }

    // ä¿®å¤æ ‡ç‚¹
    function fixPunctuation() {
      const resultsDiv = document.getElementById('typography-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨ä¿®å¤æ ‡ç‚¹...</div>';
      sendMessage('fix-punctuation');
    }

    // æ·»åŠ ä¸­æ–‡èµ„æº
    function addChineseResources() {
      const resultsDiv = document.getElementById('typography-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨æ·»åŠ èµ„æº...</div>';
      sendMessage('add-chinese-resources');
    }

    // ç¿»è¯‘æ–‡æœ¬
    function translateText() {
      const targetLang = document.getElementById('target-language').value;
      const text = document.getElementById('translate-text').value;
      const resultsDiv = document.getElementById('translation-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨ç¿»è¯‘...</div>';
      sendMessage('translate-text', { text, targetLang });
    }

    // ç”Ÿæˆä¸­æ–‡å†…å®¹
    function generateChineseContent() {
      const type = document.getElementById('content-type').value;
      const length = parseInt(document.getElementById('content-length').value);
      const resultsDiv = document.getElementById('content-results');
      resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>æ­£åœ¨ç”Ÿæˆå†…å®¹...</div>';
      sendMessage('generate-chinese-content', { type, length });
    }

    // å¤„ç†æ¥è‡ªæ’ä»¶ä»£ç çš„æ¶ˆæ¯
    onmessage = (event) => {
      const { type, ...data } = event.data.pluginMessage;
      
      switch (type) {
        case 'font-applied':
        case 'punctuation-fixed':
        case 'resources-added':
          handleStatusMessage(data.message, 'typography-results');
          break;
        case 'typography-checked':
          handleTypographyCheck(data);
          break;
        case 'text-translated':
          handleTextTranslated(data);
          break;
        case 'content-generated':
          handleContentGenerated(data);
          break;
        case 'error':
          handleErrorMessage(data.message, 'typography-results');
          break;
      }
    };

    // å¤„ç†çŠ¶æ€æ¶ˆæ¯
    function handleStatusMessage(message, targetId) {
      const resultsDiv = document.getElementById(targetId);
      resultsDiv.innerHTML = `<div class="status-message">${message}</div>`;
    }

    // å¤„ç†é”™è¯¯æ¶ˆæ¯
    function handleErrorMessage(message, targetId) {
      const resultsDiv = document.getElementById(targetId);
      resultsDiv.innerHTML = `<div class="error-message">${message}</div>`;
    }

    // å¤„ç†æ’ç‰ˆæ£€æŸ¥ç»“æœ
    function handleTypographyCheck(data) {
      const resultsDiv = document.getElementById('typography-results');
      let html = `<div class="status-message">${data.message}</div>`;
      
      if (data.issues && data.issues.length > 0) {
        html += '<h3 style="font-size: 14px; margin: 16px 0 8px;">å‘ç°çš„é—®é¢˜:</h3>';
        data.issues.forEach(issue => {
          html += `
            <div class="rule-item">
              <div class="rule-name">${issue.type}</div>
              <div class="rule-description">${issue.description}</div>
              <div class="rule-examples">ä½ç½®: ${issue.location}</div>
            </div>
          `;
        });
      }
      
      resultsDiv.innerHTML = html;
    }

    // å¤„ç†æ–‡æœ¬ç¿»è¯‘ç»“æœ
    function handleTextTranslated(data) {
      const resultsDiv = document.getElementById('translation-results');
      resultsDiv.innerHTML = `
        <div class="status-message">${data.message}</div>
        <div style="margin-top: 12px;">
          <h3 style="font-size: 14px; margin-bottom: 8px;">åŸæ–‡:</h3>
          <div style="background-color: #f9f9f9; padding: 12px; border-radius: 4px;">${data.originalText}</div>
          <h3 style="font-size: 14px; margin: 12px 0 8px;">è¯‘æ–‡:</h3>
          <div style="background-color: #f9f9f9; padding: 12px; border-radius: 4px;">${data.translatedText}</div>
        </div>
      `;
    }

    // å¤„ç†å†…å®¹ç”Ÿæˆç»“æœ
    function handleContentGenerated(data) {
      const resultsDiv = document.getElementById('content-results');
      resultsDiv.innerHTML = `
        <div class="status-message">${data.message}</div>
        <div style="margin-top: 12px;">
          <h3 style="font-size: 14px; margin-bottom: 8px;">ç”Ÿæˆçš„å†…å®¹:</h3>
          <div style="background-color: #f9f9f9; padding: 12px; border-radius: 4px; white-space: pre-wrap;">${data.content}</div>
        </div>
      `;
    }
  </script>
</body>
</html>
